using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Globalization;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using Ecoplus.domain.core.Interfaces.Repository;
using Ecoplus.Infrastructure.Repository;

namespace Ecoplustest.Feuilles
{
    public partial class Details_expl : Form
    {
        IExploitantRepositories _exploitant=new ExploitantRepositories();
        public Details_expl()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            var nom=textBox1.Text;
            var prenom=textBox2.Text;
            var adresse=textBox3.Text;
            var tel=textBox4.Text;
            var surface= float.Parse(textBox5.Text);
            var departement=textBox6.Text;
            var ville=textBox7.Text;
           
            var nature = comboBox1.Text;
            var surfacetotale =float.Parse(textBox8.Text);
            var iduser = 0;

            var monexpl=new Ecoplus.domain.core.Aggregats.Exploitant( nom,
                prenom,adresse,tel,surface,surfacetotale,departement,ville,
                nature,iduser);
            if (Exploitants.Id!=0)
            {

                var result = _exploitant.Modifier(Exploitants.Id,monexpl);

                MessageBox.Show(@"Modifié avec succes ");
                Close();

            }
            else
            {
                
                var result =_exploitant.Enregistrer(monexpl);
          
                 MessageBox.Show(@"Enregistré avec succes ");
                Close();

            }
          
 
        }

        private void button2_Click(object sender, EventArgs e)
        {
            Close();
        }

        private void Details_expl_Load(object sender, EventArgs e)
        {
            
            comboBox1.SelectedIndex = 0;
            if(Exploitants.Id==0)return;
            if (Exploitants.Id != 0) button1.Text = @"Modifier";
            textBox1.Text = Exploitants.monExploitant.Nom;
            textBox2.Text = Exploitants.monExploitant.Prenom;
            textBox3.Text = Exploitants.monExploitant.District;
            textBox4.Text = Exploitants.monExploitant.Tel;
            textBox5.Text = Exploitants.monExploitant.Surface.ToString(CultureInfo.InvariantCulture);
            textBox8.Text = Exploitants.monExploitant.SurfaceTotal.ToString(CultureInfo.InvariantCulture);
            textBox6.Text = Exploitants.monExploitant.Departement;
            textBox7.Text = Exploitants.monExploitant.Ville;
            comboBox1.Text = Exploitants.monExploitant.Nature;
         

        }

        private void Details_expl_FormClosed(object sender, FormClosedEventArgs e)
        {
            Exploitants.Id = 0;
        }
    }
}
